// Enable monitoring and logging
timeline.enabled            = true
trace.enabled               = true
dag.enabled                 = true

// Define pipeline parameters
params {
    author               = 'name'
    condition            = 'normal'
    datasets_csv         = 'data/homo_sapiens_kidney_mini_lake.csv'
    embedding_key_ch     = 'X_umap'
    gencode_release      = 49
    h5ad_ch              = 'adata_normal_n3566.h5ad'
    label_key_ch         = 'subclass.l3'
    metric               = 'euclidean'
    organism             = 'Homo sapiens'
    publication_date     = '2023'
    publication          = 'Lake'
    tissue               = 'kidney'
    outdir               = 'results'
    save_annotation      = true
    save_cluster_summary = true
    save_scores          = true
    silhouette_score     = 'silhouette_score'
    sort_by              = 'median'
    score_col            = 'silhouette_score'
}


// Enable docker
docker {
  enabled = true
  runOptions = ''
  pull = false
}

 process {
    withName: build_symbol_map_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }
    
    withName: run_dendrogramplot_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }
    
    withName: run_dotplot_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: filter_condition_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: filter_tissue_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: run_matrixplot_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }
    
    withName: log_nsforest_version_process {
        container = 'nsforest-arm64:latest'
	maxForks = 3
        cpus = 4
        memory = '8 GB'
    }

    withName: prep_binary_scores_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: prep_medians_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: run_nsforest_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

    withName: sanitize_labels_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }
    
    withName: symbolize_genes_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }
    
    withName: run_violinplot_process {
        container = 'nsforest-arm64:latest'
	maxForks = 7
        cpus = 8
        memory = '4 GB'
    }

}